#!/bin/bash

PATH="$PATH:$HOME/bin"

# daemonize command and ingore all output
function run {
    restart=false
    # restart service if -r flag is present
    if [[ $1 == '-r' ]]; then
        restart=true
        shift
    fi
    if [[ $1 == '-c' ]]; then
        command_name=$2
        shift 2
    else
        command_name=$1
    fi
	command=$1
	shift
	# get the arguments
	args=$@
	
    printf "Checking: %-20s" "$command_name"
    if $restart; then
        killall $command 2> /dev/null
    fi
	if ! pgrep -f -d ", " $command_name; then
		echo "STARTING"
		nohup $command $args >> ~/.awesome_apps  2>&1 &
	fi
}

####### programs to run ########

cd /tmp

echo "### Autostarting programs:"

run urxvtd -q -f -o
run -c nvim urxvtc -title -e nvim

run -r nm-applet
run -r mate-power-manager
run -r blueman-applet
run -r pasystray

run xbindkeys
run thunar --daemon
run synergy
run skype
#run remmina > /dev/null 2>&1
#run mpdstream.sh
#run virt-manager
#run zeal -style=gtk

# start the usual terminal windows
if ! pgrep ncmpcpp &>/dev/null; then
	# Start mpd client
	urxvtc -name ncmpcpp -e ncmpcpp &
fi
